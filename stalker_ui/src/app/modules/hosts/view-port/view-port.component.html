@if (host$ | async; as host) {
  <div class="container">
    <app-page-header
      [backRoute]="['..', '..']"
      [parts]="[(companies$ | async | whereId : [host?.companyId])?.name, host.ip, (port$ | async)?.port]"
    ></app-page-header>
    <div class="content-wrapper">
      <div class="content">
        <findings-list [correlationKey]="(port$ | async)?.correlationKey"></findings-list>
      </div>
      <div class="context">
        @if (port$ | async; as port) {
          <panel-section>
            <panel-section-title i18n="Last seen|Last seen">Last seen</panel-section-title>
            <panel-section-subtitle [matTooltip]="port.lastSeen | humanizeDate : 'precise'" matTooltipPosition="before">
              {{ port.lastSeen | timeAgo }}
            </panel-section-subtitle>
          </panel-section>
        }
        @if ((tagsSelectItems$ | async) && mergedTags$ | async; as portTags) {
          <panel-section>
            <panel-section-title i18n="Tags|The tags of an item"
              >Tags
          <span class="manage-tags-menu">
            â€”
            <app-text-select-menu
              [menuMaxSize]="menuTargetWidth"
              [items]="tagsSelectItems$ | async"
              [buttonText]="manageTags"
              [filterText]="filterTags"
              [filterEnabled]="true"
              [colorEnabled]="true"
              [opacity]="0.8"
              [emptyText]="emptyTags"
              (itemSelection)="itemSelected($event)"
            ></app-text-select-menu>
          </span>
        </panel-section-title>
            @if (!portTags.length) {
              <panel-section-subtitle i18n="No tags yet|There are no tags for this item"
                >No tags yet
        </panel-section-subtitle>
            }
            @for (tag of portTags; track tag) {
              <app-pill-tag [color]="(tags | whereId : [tag])?.color">{{
                (tags | whereId : [tag])?.text
              }}</app-pill-tag>
            }
          </panel-section>
        }
        <panel-section>
          <panel-section-title i18n="Host|The ip related to a port">IP address</panel-section-title>
          <a [routerLink]="['/hosts', host._id]">{{ host.ip }}</a>
        </panel-section>
        @if (ports$ | async; as ports) {
          <panel-section>
            <panel-section-title i18n="Ports|An IP's related ports">Host Ports</panel-section-title>
            @for (port of ports$ | async; track port) {
              <div>
                <a [routerLink]="['../..', 'ports', port.port]">{{ port.port }}</a>
              </div>
            }
            @if (((shownPortsCount$ | async) ?? 0) < (ports.length ?? 0)) {
              <button
                panel-load-more
                (click)="shownPortsCount$.next(1000)"
                >
                Show more ({{ ports.length }})
              </button>
            }
          </panel-section>
        }
        <mat-divider></mat-divider>
        <panel-section class="management" #managementPanelSection>
          <app-text-menu [buttonText]="managePortText" [iconName]="'settings'" [xPosition]="'before'">
            <div [style.width.px]="menuTargetWidth - 16" class="management-content">
              <button mat-flat-button color="warn" class="full-width" (click)="deletePort()">
                <label i18n="Delete|Delete an item">Delete</label>
              </button>
            </div>
          </app-text-menu>
        </panel-section>
      </div>
    </div>
  </div>
}
