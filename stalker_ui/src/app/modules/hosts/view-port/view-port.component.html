<div class="container" *ngIf="host$ | async as host">
  <app-page-header
    [backRoute]="['..', '..']"
    [parts]="[(companies$ | async | whereId : [host?.companyId])?.name, host.ip, (port$ | async)?.port]"
  ></app-page-header>

  <div class="content-wrapper">
    <div class="content">
      <findings-list [correlationKey]="(port$ | async)?.correlationKey"></findings-list>
    </div>

    <div class="context">
      <panel-section>
        <button mat-flat-button color="warn" class="full-width" (click)="deletePort()">
          <label i18n="Delete|Delete an item">Delete</label>
        </button>
      </panel-section>

      <mat-divider></mat-divider>

      <panel-section *ngIf="(tagsSelectItems$ | async) && mergedTags$ | async as portTags">
        <panel-section-title i18n="Tags|The tags of an item"
          >Tags
          <span class="manage-tags-menu">
            â€”
            <app-text-select-menu
              [items]="tagsSelectItems$ | async"
              [buttonText]="manageTags"
              [filterText]="filterTags"
              [filterEnabled]="true"
              [colorEnabled]="true"
              [opacity]="0.8"
              [emptyText]="emptyTags"
              (itemSelection)="itemSelected($event)"
            ></app-text-select-menu>
          </span>
        </panel-section-title>

        <panel-section-subtitle *ngIf="!portTags.length" i18n="No tags yet|There are no tags for this item"
          >No tags yet
        </panel-section-subtitle>

        <app-pill-tag *ngFor="let tag of portTags" [color]="(tags | whereId : [tag])?.color">{{
          (tags | whereId : [tag])?.text
        }}</app-pill-tag>
      </panel-section>

      <panel-section>
        <panel-section-title i18n="Host|The ip related to a port">IP address</panel-section-title>
        <a [routerLink]="['/hosts', host._id]">{{ host.ip }}</a>
      </panel-section>
      <panel-section *ngIf="ports$ | async as ports">
        <panel-section-title i18n="Ports|An IP's related ports">Host Ports</panel-section-title>
        <div *ngFor="let port of ports$ | async">
          <a [routerLink]="['../..', 'ports', port.port]">{{ port.port }}</a>
        </div>

        <button
          panel-load-more
          *ngIf="((shownPortsCount$ | async) ?? 0) < (ports.length ?? 0)"
          (click)="shownPortsCount$.next(1000)"
        >
          Show more ({{ ports.length }})
        </button>
      </panel-section>
    </div>
  </div>
</div>
