<div class="container full-height" *ngIf="host$ | async as host">
  <mat-drawer-container class="full-height" autosize="true">
    <h1>
      <button type="button" mat-icon-button routerLinkActive="list-item-active" routerLink="/hosts">
        <mat-icon class="material-icons-outlined">arrow_back</mat-icon>
      </button>
      <div *ngIf="host">{{ (companies$ | async | whereId: [host?.companyId])?.name }} / Hosts / {{ host.ip }}</div>
    </h1>
    <div class="content">
      <mat-card>
        <mat-card-header>
          <mat-card-title i18n="Domains|The domains related to an IP address">Domains</mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <table mat-table [dataSource]="(domains$ | async) ?? []">
            <!-- IP Address Column -->
            <ng-container matColumnDef="domainName">
              <th mat-header-cell *matHeaderCellDef i18n="Domain|A domain name">Domain</th>
              <td mat-cell *matCellDef="let element">
                <a [routerLink]="['/domains', element.id]" routerLinkActive="router-link-active">{{ element.name }}</a>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['domainName']"></tr>
            <tr
              mat-row
              *matRowDef="let row; columns: ['domainName']"
              class="rows rows-cursor"
              (click)="selectDomainAndView(row)"
              [class.selected-host]="selectedDomain?.id === row.id"
            ></tr>

            <tr class="mat-row nodata" *matNoDataRow>
              <td class="mat-cell" colspan="100%" i18n="No hosts found|No hosts were found for this item">
                No hosts found
              </td>
            </tr>
          </table>

          <div class="show-all-button-wrapper">
            <button
              *ngIf="((shownDomainsCount$ | async) ?? 0) < (host?.domains?.length ?? 0)"
              class="show-all-button"
              mat-button
              i18n="Show all|Call to action for loading all IP addresses related to a domain."
              (click)="shownDomainsCount$.next(1000)"
            >
              Show all ({{ host?.domains }})
            </button>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-card-title i18n="Ports|The ports related to a an IP">Ports</mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <table mat-table [dataSource]="(ports$ | async) ?? []">
            <!-- IP Address Column -->
            <ng-container matColumnDef="port">
              <th mat-header-cell *matHeaderCellDef i18n="Ports|Ports">Ports</th>
              <td mat-cell *matCellDef="let element">{{ element.number }}</td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['port']"></tr>
            <tr
              mat-row
              *matRowDef="let row; columns: ['port']"
              class="rows rows-cursor"
              (click)="selectDomainAndView(row)"
              [class.selected-host]="selectedDomain?.id === row.id"
            ></tr>

            <tr class="mat-row nodata" *matNoDataRow>
              <td class="mat-cell" colspan="100%" i18n="No ports found yet|No ports were found for this item">
                No ports found yet
              </td>
            </tr>
          </table>

          <div class="show-all-button-wrapper">
            <button
              *ngIf="((shownDomainsCount$ | async) ?? 0) < (host?.domains?.length ?? 0)"
              class="show-all-button"
              mat-button
              i18n="Show all|Call to action for loading all IP addresses related to a domain."
              (click)="shownDomainsCount$.next(1000)"
            >
              Show all ({{ host?.domains }})
            </button>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-card-title i18n="Note|A note">Note</mat-card-title>
        </mat-card-header>

        <mat-card-content class="note">You can't add a note yet.</mat-card-content>
      </mat-card>
    </div>

    <mat-drawer class="mat-elevation-z2" opened mode="side" position="end">
      <!-- <button mat-icon-button *ngIf="hostDetails$ != null" class="close-panel" (click)="close()">
        <mat-icon>close</mat-icon>
      </button> -->

      <!-- <div *ngIf="hostDetails$ == null"> -->
      <findings-list [correlationKey]="host.correlationKey"></findings-list>
      <!-- </div> -->

      <!-- <div *ngIf="hostDetails$ | async as host">
        <host-details [host]="host" [company]="companies$ | async | whereId: [host?.companyId]"></host-details>
        <findings-list [correlationKey]="host.correlationKey"></findings-list>
      </div> -->
    </mat-drawer>
  </mat-drawer-container>
</div>
