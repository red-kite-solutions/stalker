<div class="table-container" fxLayout="column">
  <!-- Search filter-->
  <mat-form-field class="filter-chip-list" appearance="fill" fxFlex>
    <mat-label i18n="Search filter|Filter your search to get more precise results">Search filter</mat-label>
    <mat-chip-list #chipList>
      <mat-chip *ngFor="let filter of filters" (click)="editFilter($event, filter)" (removed)="removeFilter(filter)">
        {{ filter }}
        <button matChipRemove>
          <mat-icon>cancel</mat-icon>
        </button>
      </mat-chip>
      <input
        tab-directive
        i18n-placeholder="New filter|Creating a new filter"
        placeholder="New filter..."
        #filterInput
        [formControl]="filterForm"
        [matAutocomplete]="auto"
        [matChipInputFor]="chipList"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        (matChipInputTokenEnd)="addFilter($event)"
        (click)="filterForm.setValue(filterForm.value ? filterForm.value : '')"
      />
    </mat-chip-list>
    <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event)" [autoActiveFirstOption]="true">
      <mat-option *ngFor="let filter of filteredColumns$ | async" [value]="filter">
        {{ filter }}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>

  <!-- <mat-progress-bar mode="indeterminate" *ngIf="isLoading"></mat-progress-bar> -->
  <table mat-table [dataSource]="dataSource" fxFlex>
    <!-- Checkbox Column -->
    <ng-container matColumnDef="select">
      <th mat-header-cell *matHeaderCellDef>
        <mat-checkbox
          (change)="$event ? masterToggle() : null"
          [checked]="selection.hasValue() && isAllSelected()"
          [indeterminate]="selection.hasValue() && !isAllSelected()"
        >
        </mat-checkbox>
      </th>
      <td mat-cell *matCellDef="let row" (click)="$event.stopPropagation()" class="check-box-cell">
        <mat-checkbox
          (click)="$event.stopPropagation()"
          (change)="$event ? selection.toggle(row) : null"
          [checked]="selection.isSelected(row)"
        >
        </mat-checkbox>
      </td>
    </ng-container>

    <ng-content></ng-content>

    <tr
      mat-row
      *matRowDef="let row; columns: columns"
      routerLinkActive="list-item-active"
      [routerLink]="[routerLinkPrefix, row._id ? row._id : row.id]"
      class="rows"
    ></tr>

    <tr class="mat-row nodata" *matNoDataRow>
      <td class="mat-cell" colspan="100%" i18n="No data|No data is matching the filter, the array is empty">
        No matching data.
      </td>
    </tr>
  </table>
  <mat-progress-bar mode="indeterminate" *ngIf="isLoading" fxFlex></mat-progress-bar>

  <mat-paginator
    fxFlex
    [length]="length"
    [pageSize]="pageSize"
    [pageSizeOptions]="pageSizeOptions"
    [pageIndex]="currentPage"
    showFirstLastButtons
    aria-label="Select page"
    (page)="pageChanged($event)"
  >
  </mat-paginator>
</div>
